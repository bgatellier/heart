.build:
  stage: build
  script:
    - node common/scripts/install-run-rush.js build --verbose
  artifacts:
    paths:
      - common/temp/node_modules/
      - modules/
      - website/.firebaserc
      - website/firebase.json
      - website/dist/
      - rush.json

.coverage:
  stage: test
  extends:
    - .install
    - .only-master
  dependencies:
    - üèó Build for master
  coverage: /Branches\s+:\s\d+.?\d+/

.install:
  before_script:
    # Update the rush.json repository url with the one used by the CI, to make the rush commands works
    - sed -i -e "s/$HOST_REPO_URL/$HOST_REPO_PIPELINE_URL/g" rush.json
    - node common/scripts/install-run-rush.js install
